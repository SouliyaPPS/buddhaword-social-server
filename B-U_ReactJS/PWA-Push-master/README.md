# PWA-Push

-----------------------------
BUILD YOUR SINGLE PAGE REACT.JS PROGRESSIVE WEB APP USING CREATE-REACT-APP
-----------------------------
1.	Install Node.js - https://nodejs.org/en/download/

2.    Install a code editor - We recommend Visual Studio Code which is a great free tool for Node.js projects - https://code.visualstudio.com/ . 
VS Code has an inbuilt powershell where you can execute your cmd commands.

3.	Create a new working folder (can open it up in VS Code if you'd like to edit/run/debug)

----
Follow steps 4-6 only if you want to generate your own React.JS app.  You can skip these if you directly sync the code from the repository in the PWA folder.  
----
4.	Install Create-React-App with Node Package Manager (npm) from cmd
      
        npm install -g create-react-app
        
5.	Restart cmd and run create-react-app to generate the web page scaffolding in your working folder under a specified project-subfolder
      
        create-react-app {project-subfolder}
                
6.    The output generated web app will automatically be a progressive web app project with public/manifest.json and src/registerServiceWorker.js; however the service worker will only be created and run in production mode when you execute - npm run build - from command line. However the code (from the PWA folder in this repository) will add a custom service worker that will work in dev mode too, when you start the web page through - npm run start.  It will also change the service worker registration from the default production-only one to our custom one.  Remember - only one service worker can be registered at a time for a web app.
----
7.    Set up Firebase Cloud Messaging from the console as shown at the workshop.  Replace "gcm_sender_id" in manifest.json with your custom ID.

8.    From cmd, run npm install from the project folder to install dependencies.  This will create a sub folder called node_modules and populate it.  This step might take a few minutes, see it through.

        npm install 

9.    From cmd, run npm run start.  This will create a server with your web app at http://localhost.com:3000 and automatically open up a browser window with that address.

        npm run start
        
-----------------------------
SEND A PUSH NOTIFICATION TO YOUR WEB APP FROM curl
-----------------------------
1.    Install curl from https://curl.haxx.se/

2.    Run the following command from cmd:
        
        curl.exe  "{endpoint}" --request POST --header "TTL: 60" --header "Content-Length: 0" --header "Authorization: key={server key}"

{endpoint} will be printed to your browser console when you run the web app above the first time (as a result of a subscription event generated by service worker - be sure to allow push notifications from the site in browser for this to work.  You don't need to have the site open when you cURL, the service worker has been installed and will handle.  

The endpoint will be a long url, it should start with "https://android.googleapis.com/gcm/send/" followed by a key

{server key} needs to be taken from your Firebase console as shown.

-----------------------------
BUILD A SERVER APP TO GENERATE A PUSH NOTIFICATION
-----------------------------
1.    Extract the contents of the NotificationSender folder to a new web folder

2.     In main.js, replace the value for {ENDPOINT} as you did with the curl method above and the Authorization key with the value from your Firebase console.

3.     From cmd, run a node server
        
        node main.js

Enjoy! - The Assembly Team
